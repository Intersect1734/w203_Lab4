knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("crime_v2_updated.csv", header = TRUE)
summary(data$crime)
hist(data$crime)
summary(data)
View(data)
data <- data[1:26]
data <- data[2:26]
summary(data)
length(unique(data$county))
length(data$county) - length(unique(data$county))
data <- data[3,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25]
kept <- c(3,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25)
data <- data[kept]
knitr::opts_chunk$set(echo = TRUE)
# Create the variable for average wage
wagevars = c("wagefed", "wagesta", "wageloc", "wagecon", "wagetuc", "wagetrd", "wagefir", "wageser", "wagemfg")
data$wage_avg = apply(data[,wagevars], 1, mean)
#Histogram of each variable in the model
layout <- par(mfrow=c(2,2))
hist(data$crime, main = "Histogram of Crime", xlab = "Crime rate (per capita)", breaks = seq(0, 0.10, 0.005))
hist(data$police, main = "Histogram of Police Presence", xlab = "Police per capita", breaks = seq(0,0.015, 0.0005))
hist(data$wage_avg, main = "Histogram of Average Wages", xlab = "Weekly wages", breaks = seq(250, 500, 25))
# Create a log(wage) variable
data$log_wage_avg <- log(data$wage_avg)
hist(data$log_wage_avg, main = "Histogram of Average Wages, log transform", xlab = "log(Weekly wages)", breaks = seq(5.4, 6.5, 0.1))
par(layout)
# Create the variable for average wage
wagevars = c("wagefed", "wagesta", "wageloc", "wagecon", "wagetuc", "wagetrd", "wagefir", "wageser", "wagemfg")
data$wage_avg = apply(data[,wagevars], 1, mean)
#Histogram of each variable in the model
layout <- par(mfrow=c(2,2))
hist(data$crime, main = "Histogram of Crime", xlab = "Crime rate (per capita)", breaks = seq(0, 0.10, 0.005))
hist(data$police, main = "Histogram of Police Presence", xlab = "Police per capita", breaks = seq(0,0.015, 0.0005))
hist(data$wage_avg, main = "Histogram of Average Wages", xlab = "Weekly wages", breaks = seq(250, 500, 25))
# Create a log(wage) variable
data$log_wage_avg <- log(data$wage_avg)
hist(data$log_wage_avg, main = "Histogram of Average Wages, log transform", xlab = "log(Weekly wages)", breaks = seq(5.4, 6.5, 0.1))
par(layout)
Model1 <- lm(crime ~ police + log_wage_avg, data = data)
summary(Model1)$r.squared
tolerance <- 1-summary(Model1)$r.squared
tolerance
tolerance1 <- 1-summary(Model1)$r.squared
tolerance1
VIF1 <- 1/tolerance1
VIF1
plot(Model1)[1]
plot(Model1, 1)
```{r,echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3,fig.show='hold',fig.align='center'}
plot(Model1, 1)
plot(Model1, 1)
plot(Model1, 2)
plot(Model1, 3)
library(car)
library(car)
library(sandwich)
library(stargazer)
library(lmtest)
library(cars)
bptest(Model1)
length(data$crime)
plot(Model1$residuals)
hist(Model1$residuals)
plot(Model1, 2)
shapiro.test(Model1)
ks.test(Model1)
?ks.test()
cdf1 <- ecdf(Model1)
plot(Model1, 3)
plot(Model1, 4)
plot(Model1, 5)
